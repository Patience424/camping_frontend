{"ast":null,"code":"import { mapGetters } from 'vuex';\nimport { campingSpotAPI } from '@/services/api';\nexport default {\n  name: 'CampingSpotDetails',\n  props: {\n    id: {\n      type: [String, Number],\n      required: true\n    }\n  },\n  data() {\n    return {\n      spot: {\n        images: [],\n        name: '',\n        location: '',\n        description: '',\n        pricePerNight: 0,\n        capacity: 1,\n        amenities: [],\n        reviews: [],\n        averageRating: null,\n        reviewCount: 0\n      },\n      isLoading: true,\n      showAllPhotos: false,\n      showReviewForm: false,\n      showBookingModal: false,\n      review: {\n        rating: 5,\n        comment: ''\n      },\n      booking: {\n        startDate: '',\n        endDate: '',\n        guestCount: 1,\n        specialRequests: ''\n      },\n      isSubmittingReview: false,\n      isSubmittingBooking: false,\n      isCheckingAvailability: false,\n      availabilityStatus: null,\n      availabilityMessage: '',\n      bookingCalculation: {\n        nights: 0,\n        subtotal: 0,\n        serviceFee: 0,\n        total: 0\n      }\n    };\n  },\n  computed: {\n    ...mapGetters(['isAuthenticated', 'userId']),\n    normalizedImages() {\n      if (!this.spot || !this.spot.images) return [];\n      return this.spot.images.map(img => typeof img === 'string' ? {\n        url: this.getImageUrl(img)\n      } : {\n        url: this.getImageUrl(img.url || img)\n      });\n    },\n    spotId() {\n      const id = parseInt(this.id);\n      if (isNaN(id)) {\n        console.error('Invalid camping spot ID:', this.id);\n        return null;\n      }\n      return id;\n    },\n    minDate() {\n      const today = new Date();\n      return today.toISOString().split('T')[0];\n    }\n  },\n  methods: {\n    formatPrice(price) {\n      return price.toFixed(2);\n    },\n    async fetchCampingSpot() {\n      try {\n        this.isLoading = true;\n        console.log('Fetching camping spot with ID:', this.spotId);\n        if (!this.spotId) {\n          throw new Error('Invalid camping spot ID');\n        }\n        const response = await campingSpotAPI.getById(this.spotId);\n        console.log('Camping spot response:', response);\n        this.spot = response;\n      } catch (error) {\n        console.error('Error fetching camping spot:', error);\n        console.error('Error response:', error.response);\n        console.error('Error status:', error.response?.status);\n        console.error('Error data:', error.response?.data);\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to load camping spot details'\n        });\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    getImageUrl(path) {\n      if (!path) return '';\n      if (typeof path === 'object') path = path.url; // support { url: '...' }\n      if (!path) return '';\n      if (path.startsWith('http')) return path;\n      return `http://localhost:3000${path.startsWith('/') ? path : '/' + path}`;\n    },\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    },\n    async submitReview() {\n      if (!this.isAuthenticated) {\n        this.$router.push('/login');\n        return;\n      }\n      try {\n        this.isSubmittingReview = true;\n        await campingSpotAPI.createReview(this.spotId, {\n          rating: this.review.rating,\n          comment: this.review.comment\n        });\n        this.showReviewForm = false;\n        this.review = {\n          rating: 5,\n          comment: ''\n        };\n        await this.fetchCampingSpot();\n        this.$store.commit('setNotification', {\n          type: 'success',\n          message: 'Review submitted successfully'\n        });\n      } catch (error) {\n        console.error('Error submitting review:', error);\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to submit review'\n        });\n      } finally {\n        this.isSubmittingReview = false;\n      }\n    },\n    calculateBookingDetails() {\n      if (!this.booking.startDate || !this.booking.endDate) {\n        this.bookingCalculation = {\n          nights: 0,\n          subtotal: 0,\n          serviceFee: 0,\n          total: 0\n        };\n        return;\n      }\n      const start = new Date(this.booking.startDate);\n      const end = new Date(this.booking.endDate);\n      const nights = Math.ceil((end - start) / (1000 * 60 * 60 * 24));\n      const subtotal = nights * this.spot.pricePerNight;\n      const serviceFee = Math.round(subtotal * 0.1); // 10% service fee\n      const total = subtotal + serviceFee;\n      this.bookingCalculation = {\n        nights,\n        subtotal,\n        serviceFee,\n        total\n      };\n    },\n    async checkAvailability() {\n      if (!this.isAuthenticated) {\n        this.$router.push('/login');\n        return;\n      }\n      try {\n        this.isCheckingAvailability = true;\n        const response = await campingSpotAPI.checkAvailability(this.spotId, {\n          startDate: this.booking.startDate,\n          endDate: this.booking.endDate,\n          guestCount: this.booking.guestCount\n        });\n        if (response.available) {\n          this.availabilityStatus = 'available';\n          this.availabilityMessage = response.message || 'These dates are available!';\n          this.showBookingModal = true;\n        } else {\n          this.availabilityStatus = 'unavailable';\n          this.availabilityMessage = response.message || 'These dates are not available. Please try different dates.';\n        }\n      } catch (error) {\n        console.error('Error checking availability:', error);\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to check availability'\n        });\n      } finally {\n        this.isCheckingAvailability = false;\n      }\n    },\n    async submitBooking() {\n      try {\n        this.isSubmittingBooking = true;\n        await campingSpotAPI.createBooking(this.spotId, {\n          startDate: this.booking.startDate,\n          endDate: this.booking.endDate,\n          guestCount: this.booking.guestCount,\n          specialRequests: this.booking.specialRequests\n        });\n        this.showBookingModal = false;\n        this.$router.push('/bookings');\n        this.$store.commit('setNotification', {\n          type: 'success',\n          message: 'Booking confirmed successfully'\n        });\n      } catch (error) {\n        console.error('Error submitting booking:', error);\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to confirm booking'\n        });\n      } finally {\n        this.isSubmittingBooking = false;\n      }\n    }\n  },\n  watch: {\n    'booking.startDate'() {\n      this.calculateBookingDetails();\n    },\n    'booking.endDate'() {\n      this.calculateBookingDetails();\n    },\n    'booking.guestCount'() {\n      this.calculateBookingDetails();\n    },\n    '$route.params.id'() {\n      this.fetchCampingSpot();\n    }\n  },\n  created() {\n    this.fetchCampingSpot();\n  }\n};","map":{"version":3,"names":["mapGetters","campingSpotAPI","name","props","id","type","String","Number","required","data","spot","images","location","description","pricePerNight","capacity","amenities","reviews","averageRating","reviewCount","isLoading","showAllPhotos","showReviewForm","showBookingModal","review","rating","comment","booking","startDate","endDate","guestCount","specialRequests","isSubmittingReview","isSubmittingBooking","isCheckingAvailability","availabilityStatus","availabilityMessage","bookingCalculation","nights","subtotal","serviceFee","total","computed","normalizedImages","map","img","url","getImageUrl","spotId","parseInt","isNaN","console","error","minDate","today","Date","toISOString","split","methods","formatPrice","price","toFixed","fetchCampingSpot","log","Error","response","getById","status","$store","commit","message","path","startsWith","formatDate","date","toLocaleDateString","year","month","day","submitReview","isAuthenticated","$router","push","createReview","calculateBookingDetails","start","end","Math","ceil","round","checkAvailability","available","submitBooking","createBooking","watch","booking.startDate","booking.endDate","booking.guestCount","$route.params.id","created"],"sources":["src/views/camping/CampingSpotDetails.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-neutral-50\">\n    <div v-if=\"isLoading\" class=\"flex justify-center items-center min-h-screen\">\n      <svg class=\"animate-spin h-10 w-10 text-primary-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n        <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\n        <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n      </svg>\n    </div>\n\n    <div v-else-if=\"!spot\" class=\"flex flex-col items-center justify-center min-h-screen\">\n      <svg class=\"w-16 h-16 text-neutral-300 mb-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n      <h2 class=\"text-2xl font-semibold mb-2\">Camping spot not found</h2>\n      <p class=\"text-neutral-600 mb-6\">The camping spot you're looking for doesn't exist or has been removed.</p>\n      <router-link to=\"/camping-spots\" class=\"btn-primary\">Browse Camping Spots</router-link>\n    </div>\n\n    <div v-else class=\"container mx-auto px-4 py-8\">\n      <!-- Header Section -->\n      <div class=\"mb-8\">\n        <h1 class=\"text-3xl font-bold mb-2\">{{ spot.name }}</h1>\n        <div class=\"flex items-center text-neutral-600\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 mr-1\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\" />\n          </svg>\n          <span>{{ spot.location }}</span>\n          <span class=\"mx-2\">•</span>\n          <div v-if=\"spot.averageRating !== null && spot.averageRating !== undefined\" class=\"flex items-center\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 text-yellow-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n            </svg>\n            <span class=\"ml-1\">{{ spot.averageRating.toFixed(1) }}</span>\n            <span class=\"ml-1\">({{ spot.reviewCount || 0 }} reviews)</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Image Gallery -->\n      <div class=\"mb-8\">\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div v-if=\"spot.images && spot.images.length > 0\" class=\"relative h-96 rounded-lg overflow-hidden\">\n            <img \n              :src=\"spot.images[0].url\" \n              :alt=\"spot.name\"\n              class=\"w-full h-full object-cover\"\n            >\n          </div>\n          <div v-if=\"spot.images && spot.images.length > 1\" class=\"grid grid-cols-2 gap-4\">\n            <div v-for=\"(image, index) in spot.images.slice(1, 5)\" :key=\"index\" class=\"relative h-44 rounded-lg overflow-hidden\">\n              <img \n                :src=\"image.url\" \n                :alt=\"`${spot.name} - Image ${index + 2}`\"\n                class=\"w-full h-full object-cover\"\n              >\n            </div>\n          </div>\n          <div v-if=\"!spot.images || spot.images.length === 0\" class=\"relative h-96 rounded-lg overflow-hidden bg-neutral-100 flex items-center justify-center\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-16 w-16 text-neutral-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n            </svg>\n          </div>\n        </div>\n        <button \n          v-if=\"spot.images && spot.images.length > 5\"\n          @click=\"showAllPhotos = true\"\n          class=\"mt-4 text-primary-600 hover:text-primary-700 font-medium\"\n        >\n          Show all {{ spot.images.length }} photos\n        </button>\n      </div>\n\n      <!-- Main Content -->\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <!-- Left Column -->\n        <div class=\"lg:col-span-2\">\n          <!-- Description -->\n          <div class=\"bg-white rounded-lg shadow-sm p-6 mb-8\">\n            <h2 class=\"text-2xl font-semibold mb-4\">About this camping spot</h2>\n            <p class=\"text-neutral-600 whitespace-pre-line\">{{ spot.description }}</p>\n          </div>\n\n          <!-- Amenities -->\n          <div class=\"bg-white rounded-lg shadow-sm p-6 mb-8\">\n            <h2 class=\"text-2xl font-semibold mb-4\">Amenities</h2>\n            <div class=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n              <div v-for=\"amenity in spot.amenities\" :key=\"amenity\" class=\"flex items-center\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 text-primary-500 mr-2\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\n                </svg>\n                <span>{{ amenity }}</span>\n              </div>\n            </div>\n          </div>\n\n          <!-- Reviews -->\n          <div class=\"bg-white rounded-lg shadow-sm p-6\">\n            <div class=\"flex justify-between items-center mb-6\">\n              <h2 class=\"text-2xl font-semibold\">Reviews</h2>\n              <button \n                v-if=\"isAuthenticated\"\n                @click=\"showReviewForm = true\"\n                class=\"btn-primary\"\n              >\n                Write a Review\n              </button>\n            </div>\n\n            <!-- Review Form -->\n            <div v-if=\"showReviewForm\" class=\"mb-8\">\n              <form @submit.prevent=\"submitReview\" class=\"space-y-4\">\n                <div>\n                  <label class=\"block text-sm font-medium text-neutral-700 mb-1\">Rating</label>\n                  <div class=\"flex items-center\">\n                    <button \n                      v-for=\"rating in 5\" \n                      :key=\"rating\"\n                      type=\"button\"\n                      @click=\"review.rating = rating\"\n                      class=\"focus:outline-none\"\n                    >\n                      <svg \n                        xmlns=\"http://www.w3.org/2000/svg\" \n                        class=\"h-8 w-8\"\n                        :class=\"rating <= review.rating ? 'text-yellow-400' : 'text-neutral-300'\"\n                        viewBox=\"0 0 20 20\" \n                        fill=\"currentColor\"\n                      >\n                        <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n                <div>\n                  <label for=\"review\" class=\"block text-sm font-medium text-neutral-700 mb-1\">Your Review</label>\n                  <textarea\n                    id=\"review\"\n                    v-model=\"review.comment\"\n                    rows=\"4\"\n                    class=\"w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                    placeholder=\"Share your experience...\"\n                    required\n                  ></textarea>\n                </div>\n                <div class=\"flex justify-end space-x-4\">\n                  <button \n                    type=\"button\"\n                    @click=\"showReviewForm = false\"\n                    class=\"btn-secondary\"\n                  >\n                    Cancel\n                  </button>\n                  <button \n                    type=\"submit\"\n                    class=\"btn-primary\"\n                    :disabled=\"isSubmittingReview\"\n                  >\n                    {{ isSubmittingReview ? 'Submitting...' : 'Submit Review' }}\n                  </button>\n                </div>\n              </form>\n            </div>\n\n            <!-- Reviews List -->\n            <div v-if=\"spot.reviews && spot.reviews.length > 0\" class=\"space-y-6\">\n              <div \n                v-for=\"review in spot.reviews\" \n                :key=\"review.id\"\n                class=\"border-b border-neutral-200 pb-6 last:border-0 last:pb-0\"\n              >\n                <div class=\"flex items-center mb-2\">\n                  <div class=\"flex items-center\">\n                    <svg \n                      v-for=\"rating in 5\" \n                      :key=\"rating\"\n                      xmlns=\"http://www.w3.org/2000/svg\" \n                      class=\"h-5 w-5\"\n                      :class=\"rating <= review.rating ? 'text-yellow-400' : 'text-neutral-300'\"\n                      viewBox=\"0 0 20 20\" \n                      fill=\"currentColor\"\n                    >\n                      <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n                    </svg>\n                  </div>\n                  <span class=\"ml-2 text-sm text-neutral-600\">{{ review.userName }}</span>\n                  <span class=\"mx-2 text-neutral-400\">•</span>\n                  <span class=\"text-sm text-neutral-600\">{{ formatDate(review.createdAt) }}</span>\n                </div>\n                <p class=\"text-neutral-600\">{{ review.comment }}</p>\n              </div>\n            </div>\n            <div v-else class=\"text-center py-8\">\n              <p class=\"text-neutral-600\">No reviews yet. Be the first to review this camping spot!</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Right Column - Booking Card -->\n        <div class=\"lg:col-span-1\">\n          <div class=\"bg-white rounded-lg shadow-sm p-6 sticky top-8\">\n            <div class=\"mb-6\">\n              <div class=\"flex items-baseline mb-2\">\n                <span class=\"text-2xl font-bold\">€{{ formatPrice(spot.pricePerNight) }}</span>\n                <span class=\"text-neutral-600 ml-1\">/night</span>\n              </div>\n              <div class=\"flex items-center text-neutral-600\">\n                <svg \n                  v-for=\"rating in 5\" \n                  :key=\"rating\"\n                  xmlns=\"http://www.w3.org/2000/svg\" \n                  class=\"h-4 w-4\"\n                  :class=\"spot.averageRating && rating <= spot.averageRating ? 'text-yellow-400' : 'text-neutral-300'\"\n                  viewBox=\"0 0 20 20\" \n                  fill=\"currentColor\"\n                >\n                  <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\n                </svg>\n                <span v-if=\"spot.averageRating\" class=\"ml-1\">{{ spot.averageRating.toFixed(1) }}</span>\n                <span class=\"ml-1\">({{ spot.reviewCount || 0 }} reviews)</span>\n              </div>\n            </div>\n\n            <form @submit.prevent=\"checkAvailability\" class=\"space-y-4\">\n              <div class=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label for=\"startDate\" class=\"block text-sm font-medium text-neutral-700 mb-1\">Check-in</label>\n                  <input\n                    id=\"startDate\"\n                    v-model=\"booking.startDate\"\n                    type=\"date\"\n                    :min=\"minDate\"\n                    required\n                    class=\"w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                  >\n                </div>\n                <div>\n                  <label for=\"endDate\" class=\"block text-sm font-medium text-neutral-700 mb-1\">Check-out</label>\n                  <input\n                    id=\"endDate\"\n                    v-model=\"booking.endDate\"\n                    type=\"date\"\n                    :min=\"booking.startDate || minDate\"\n                    required\n                    class=\"w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                  >\n                </div>\n              </div>\n\n              <div>\n                <label for=\"guestCount\" class=\"block text-sm font-medium text-neutral-700 mb-1\">Guests</label>\n                <select\n                  id=\"guestCount\"\n                  v-model=\"booking.guestCount\"\n                  required\n                  class=\"w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                >\n                  <option v-for=\"n in spot.capacity\" :key=\"n\" :value=\"n\">{{ n }} {{ n === 1 ? 'guest' : 'guests' }}</option>\n                </select>\n              </div>\n\n              <div v-if=\"availabilityStatus\" class=\"p-4 rounded-md\" :class=\"availabilityStatus === 'available' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'\">\n                {{ availabilityMessage }}\n              </div>\n\n              <div v-if=\"bookingCalculation.nights > 0\" class=\"space-y-2 pt-4 border-t border-neutral-200\">\n                <div class=\"flex justify-between\">\n                  <span>€{{ formatPrice(spot.pricePerNight) }} × {{ bookingCalculation.nights }} nights</span>\n                  <span>€{{ formatPrice(bookingCalculation.subtotal) }}</span>\n                </div>\n                <div class=\"flex justify-between\">\n                  <span>Service fee</span>\n                  <span>€{{ formatPrice(bookingCalculation.serviceFee) }}</span>\n                </div>\n                <div class=\"flex justify-between font-bold pt-2 border-t border-neutral-200\">\n                  <span>Total</span>\n                  <span>€{{ formatPrice(bookingCalculation.total) }}</span>\n                </div>\n              </div>\n\n              <button \n                type=\"submit\"\n                class=\"w-full btn-primary\"\n                :disabled=\"isCheckingAvailability || !booking.startDate || !booking.endDate\"\n              >\n                {{ isCheckingAvailability ? 'Checking...' : 'Check Availability' }}\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Booking Modal -->\n    <div v-if=\"showBookingModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div class=\"bg-white rounded-lg max-w-lg w-full p-6\">\n        <h2 class=\"text-2xl font-semibold mb-4\">Complete Your Booking</h2>\n        <form @submit.prevent=\"submitBooking\" class=\"space-y-4\">\n          <div>\n            <label for=\"specialRequests\" class=\"block text-sm font-medium text-neutral-700 mb-1\">Special Requests (Optional)</label>\n            <textarea\n              id=\"specialRequests\"\n              v-model=\"booking.specialRequests\"\n              rows=\"4\"\n              class=\"w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n              placeholder=\"Any special requests or requirements?\"\n            ></textarea>\n          </div>\n\n          <div class=\"space-y-2 pt-4 border-t border-neutral-200\">\n            <div class=\"flex justify-between\">\n              <span>€{{ formatPrice(spot.pricePerNight) }} × {{ bookingCalculation.nights }} nights</span>\n              <span>€{{ formatPrice(bookingCalculation.subtotal) }}</span>\n            </div>\n            <div class=\"flex justify-between\">\n              <span>Service fee</span>\n              <span>€{{ formatPrice(bookingCalculation.serviceFee) }}</span>\n            </div>\n            <div class=\"flex justify-between font-bold pt-2 border-t border-neutral-200\">\n              <span>Total</span>\n              <span>€{{ formatPrice(bookingCalculation.total) }}</span>\n            </div>\n          </div>\n\n          <div class=\"flex justify-end space-x-4\">\n            <button \n              type=\"button\"\n              @click=\"showBookingModal = false\"\n              class=\"btn-secondary\"\n            >\n              Cancel\n            </button>\n            <button \n              type=\"submit\"\n              class=\"btn-primary\"\n              :disabled=\"isSubmittingBooking\"\n            >\n              {{ isSubmittingBooking ? 'Processing...' : 'Confirm Booking' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { campingSpotAPI } from '@/services/api'\n\nexport default {\n  name: 'CampingSpotDetails',\n  props: {\n    id: {\n      type: [String, Number],\n      required: true\n    }\n  },\n  data() {\n    return {\n      spot: {\n        images: [],\n        name: '',\n        location: '',\n        description: '',\n        pricePerNight: 0,\n        capacity: 1,\n        amenities: [],\n        reviews: [],\n        averageRating: null,\n        reviewCount: 0\n      },\n      isLoading: true,\n      showAllPhotos: false,\n      showReviewForm: false,\n      showBookingModal: false,\n      review: {\n        rating: 5,\n        comment: ''\n      },\n      booking: {\n        startDate: '',\n        endDate: '',\n        guestCount: 1,\n        specialRequests: ''\n      },\n      isSubmittingReview: false,\n      isSubmittingBooking: false,\n      isCheckingAvailability: false,\n      availabilityStatus: null,\n      availabilityMessage: '',\n      bookingCalculation: {\n        nights: 0,\n        subtotal: 0,\n        serviceFee: 0,\n        total: 0\n      }\n    }\n  },\n  computed: {\n    ...mapGetters(['isAuthenticated', 'userId']),\n    normalizedImages() {\n    if (!this.spot || !this.spot.images) return [];\n    return this.spot.images.map(img =>\n      typeof img === 'string'\n        ? { url: this.getImageUrl(img) }\n        : { url: this.getImageUrl(img.url || img) }\n    );\n  },\n    spotId() {\n      const id = parseInt(this.id)\n      if (isNaN(id)) {\n        console.error('Invalid camping spot ID:', this.id)\n        return null\n      }\n      return id\n    },\n    \n    minDate() {\n      const today = new Date()\n      return today.toISOString().split('T')[0]\n    }\n  },\n  methods: {\n    formatPrice(price) {\n      return price.toFixed(2)\n    },\n\n    async fetchCampingSpot() {\n      try {\n        this.isLoading = true\n        console.log('Fetching camping spot with ID:', this.spotId)\n        if (!this.spotId) {\n          throw new Error('Invalid camping spot ID')\n        }\n        const response = await campingSpotAPI.getById(this.spotId)\n        console.log('Camping spot response:', response)\n        this.spot = response\n      } catch (error) {\n        console.error('Error fetching camping spot:', error)\n        console.error('Error response:', error.response)\n        console.error('Error status:', error.response?.status)\n        console.error('Error data:', error.response?.data)\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to load camping spot details'\n        })\n      } finally {\n        this.isLoading = false\n      }\n    },\n    getImageUrl(path) {\n    if (!path) return '';\n    if (typeof path === 'object') path = path.url; // support { url: '...' }\n    if (!path) return '';\n    if (path.startsWith('http')) return path;\n    return `http://localhost:3000${path.startsWith('/') ? path : '/' + path}`;\n    },\n\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      })\n    },\n\n    async submitReview() {\n      if (!this.isAuthenticated) {\n        this.$router.push('/login')\n        return\n      }\n\n      try {\n        this.isSubmittingReview = true\n        await campingSpotAPI.createReview(this.spotId, {\n          rating: this.review.rating,\n          comment: this.review.comment\n        })\n        \n        this.showReviewForm = false\n        this.review = { rating: 5, comment: '' }\n        await this.fetchCampingSpot()\n        \n        this.$store.commit('setNotification', {\n          type: 'success',\n          message: 'Review submitted successfully'\n        })\n      } catch (error) {\n        console.error('Error submitting review:', error)\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to submit review'\n        })\n      } finally {\n        this.isSubmittingReview = false\n      }\n    },\n\n    calculateBookingDetails() {\n      if (!this.booking.startDate || !this.booking.endDate) {\n        this.bookingCalculation = {\n          nights: 0,\n          subtotal: 0,\n          serviceFee: 0,\n          total: 0\n        }\n        return\n      }\n\n      const start = new Date(this.booking.startDate)\n      const end = new Date(this.booking.endDate)\n      const nights = Math.ceil((end - start) / (1000 * 60 * 60 * 24))\n      \n      const subtotal = nights * this.spot.pricePerNight\n      const serviceFee = Math.round(subtotal * 0.1) // 10% service fee\n      const total = subtotal + serviceFee\n\n      this.bookingCalculation = {\n        nights,\n        subtotal,\n        serviceFee,\n        total\n      }\n    },\n\n    async checkAvailability() {\n      if (!this.isAuthenticated) {\n        this.$router.push('/login')\n        return\n      }\n\n      try {\n        this.isCheckingAvailability = true\n        const response = await campingSpotAPI.checkAvailability(this.spotId, {\n          startDate: this.booking.startDate,\n          endDate: this.booking.endDate,\n          guestCount: this.booking.guestCount\n        })\n\n        if (response.available) {\n          this.availabilityStatus = 'available'\n          this.availabilityMessage = response.message || 'These dates are available!'\n          this.showBookingModal = true\n        } else {\n          this.availabilityStatus = 'unavailable'\n          this.availabilityMessage = response.message || 'These dates are not available. Please try different dates.'\n        }\n      } catch (error) {\n        console.error('Error checking availability:', error)\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to check availability'\n        })\n      } finally {\n        this.isCheckingAvailability = false\n      }\n    },\n\n    async submitBooking() {\n      try {\n        this.isSubmittingBooking = true\n        await campingSpotAPI.createBooking(this.spotId, {\n          startDate: this.booking.startDate,\n          endDate: this.booking.endDate,\n          guestCount: this.booking.guestCount,\n          specialRequests: this.booking.specialRequests\n        })\n\n        this.showBookingModal = false\n        this.$router.push('/bookings')\n        \n        this.$store.commit('setNotification', {\n          type: 'success',\n          message: 'Booking confirmed successfully'\n        })\n      } catch (error) {\n        console.error('Error submitting booking:', error)\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to confirm booking'\n        })\n      } finally {\n        this.isSubmittingBooking = false\n      }\n    }\n  },\n  watch: {\n    'booking.startDate'() {\n      this.calculateBookingDetails()\n    },\n    'booking.endDate'() {\n      this.calculateBookingDetails()\n    },\n    'booking.guestCount'() {\n      this.calculateBookingDetails()\n    },\n    '$route.params.id'() {\n      this.fetchCampingSpot()\n    }\n  },\n  created() {\n    this.fetchCampingSpot()\n  }\n}\n</script>\n\n<style scoped>\n.btn-primary {\n  background-color: var(--color-primary-600);\n  color: white;\n  padding: 0.5rem 1rem;\n  border-radius: 0.375rem;\n}\n\n.btn-primary:hover {\n  background-color: var(--color-primary-700);\n}\n\n.btn-primary:focus {\n  outline: none;\n  box-shadow: 0 0 0 2px var(--color-primary-500);\n  box-shadow: 0 0 0 4px white;\n}\n\n.btn-primary:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background-color: white;\n  color: var(--color-neutral-700);\n  padding: 0.5rem 1rem;\n  border-radius: 0.375rem;\n  border: 1px solid var(--color-neutral-300);\n}\n\n.btn-secondary:hover {\n  background-color: var(--color-neutral-50);\n}\n\n.btn-secondary:focus {\n  outline: none;\n  box-shadow: 0 0 0 2px var(--color-primary-500);\n  box-shadow: 0 0 0 4px white;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}