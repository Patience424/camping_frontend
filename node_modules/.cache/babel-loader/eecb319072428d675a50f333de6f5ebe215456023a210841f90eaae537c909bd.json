{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { userAPI, bookingAPI } from '@/services/api';\nimport { useStore } from 'vuex';\nexport default {\n  __name: 'UserBookings',\n  setup(__props) {\n    const store = useStore();\n    const bookings = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const isCancelling = ref(null);\n    function formatDate(dateString) {\n      if (!dateString) return 'Not specified';\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('en-US', {\n          weekday: 'long',\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        });\n      } catch (e) {\n        console.error('Error formatting date:', e);\n        return dateString;\n      }\n    }\n    async function cancelBooking(bookingId) {\n      if (!confirm('Are you sure you want to cancel this booking?')) {\n        return;\n      }\n      try {\n        isCancelling.value = bookingId;\n        await bookingAPI.cancel(bookingId);\n\n        // Update the booking status in the local list\n        const booking = bookings.value.find(b => b.id === bookingId);\n        if (booking) {\n          booking.status = 'CANCELLED';\n        }\n        store.commit('setNotification', {\n          type: 'success',\n          message: 'Booking cancelled successfully'\n        });\n      } catch (err) {\n        console.error('Failed to cancel booking:', err);\n        store.commit('setNotification', {\n          type: 'error',\n          message: err.response?.data?.message || 'Failed to cancel booking'\n        });\n      } finally {\n        isCancelling.value = null;\n      }\n    }\n    onMounted(async () => {\n      try {\n        console.log('Fetching bookings...');\n        const data = await userAPI.getBookings();\n        console.log('Bookings data:', data);\n        bookings.value = Array.isArray(data) ? data : [];\n        console.log('Processed bookings:', bookings.value);\n      } catch (err) {\n        console.error('Failed to load bookings:', err);\n        error.value = err.response?.data?.message || 'Failed to load bookings';\n        bookings.value = [];\n      } finally {\n        loading.value = false;\n      }\n    });\n    return {\n      __sfc: true,\n      store,\n      bookings,\n      loading,\n      error,\n      isCancelling,\n      formatDate,\n      cancelBooking\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","userAPI","bookingAPI","useStore","store","bookings","loading","error","isCancelling","formatDate","dateString","date","Date","toLocaleDateString","weekday","year","month","day","e","console","cancelBooking","bookingId","confirm","value","cancel","booking","find","b","id","status","commit","type","message","err","response","data","log","getBookings","Array","isArray"],"sources":["UserBookings.vue"],"sourcesContent":["<template>\r\n  <div class=\"bookings-page\">\r\n    <h2>Your Bookings</h2>\r\n    \r\n    <div v-if=\"loading\" class=\"loading\">\r\n      Loading your bookings...\r\n    </div>\r\n    \r\n    <template v-else>\r\n      <div v-if=\"error\" class=\"error\">\r\n        {{ error }}\r\n      </div>\r\n      \r\n      <template v-else>\r\n        <div v-if=\"bookings && bookings.length > 0\" class=\"bookings-list\">\r\n          <div v-for=\"booking in bookings\" :key=\"booking.id\" class=\"booking-card\">\r\n            <div class=\"booking-header\">\r\n              <h3>{{ booking.campingSpot?.name || 'Unknown Spot' }}</h3>\r\n              <span class=\"status\" :class=\"booking.status?.toLowerCase() || 'confirmed'\">\r\n                {{ booking.status || 'Confirmed' }}\r\n              </span>\r\n            </div>\r\n            \r\n            <div class=\"booking-info\">\r\n              <div class=\"info-row\">\r\n                <span class=\"label\">Check-in:</span>\r\n                <span class=\"value\">{{ formatDate(booking.startDate) }}</span>\r\n              </div>\r\n              <div class=\"info-row\">\r\n                <span class=\"label\">Check-out:</span>\r\n                <span class=\"value\">{{ formatDate(booking.endDate) }}</span>\r\n              </div>\r\n              <div class=\"info-row\">\r\n                <span class=\"label\">Guests:</span>\r\n                <span class=\"value\">{{ booking.guestCount || 1 }} person(s)</span>\r\n              </div>\r\n              <div class=\"info-row\" v-if=\"booking.specialRequests\">\r\n                <span class=\"label\">Special Requests:</span>\r\n                <span class=\"value\">{{ booking.specialRequests }}</span>\r\n              </div>\r\n              <div class=\"booking-actions\" v-if=\"booking.status === 'PENDING' || booking.status === 'CONFIRMED'\">\r\n                <button \r\n                  @click=\"cancelBooking(booking.id)\" \r\n                  class=\"btn-cancel\"\r\n                  :disabled=\"isCancelling === booking.id\"\r\n                >\r\n                  {{ isCancelling === booking.id ? 'Cancelling...' : 'Cancel Booking' }}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div v-else class=\"no-bookings\">\r\n          <p>No bookings yet.</p>\r\n          <router-link to=\"/camping-spots\" class=\"browse-link\">\r\n            Browse Camping Spots\r\n          </router-link>\r\n        </div>\r\n      </template>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport { userAPI, bookingAPI } from '@/services/api';\r\nimport { useStore } from 'vuex';\r\n\r\nconst store = useStore();\r\nconst bookings = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\nconst isCancelling = ref(null);\r\n\r\nfunction formatDate(dateString) {\r\n  if (!dateString) return 'Not specified';\r\n  try {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('en-US', {\r\n      weekday: 'long',\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric'\r\n    });\r\n  } catch (e) {\r\n    console.error('Error formatting date:', e);\r\n    return dateString;\r\n  }\r\n}\r\n\r\nasync function cancelBooking(bookingId) {\r\n  if (!confirm('Are you sure you want to cancel this booking?')) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    isCancelling.value = bookingId;\r\n    await bookingAPI.cancel(bookingId);\r\n    \r\n    // Update the booking status in the local list\r\n    const booking = bookings.value.find(b => b.id === bookingId);\r\n    if (booking) {\r\n      booking.status = 'CANCELLED';\r\n    }\r\n\r\n    store.commit('setNotification', {\r\n      type: 'success',\r\n      message: 'Booking cancelled successfully'\r\n    });\r\n  } catch (err) {\r\n    console.error('Failed to cancel booking:', err);\r\n    store.commit('setNotification', {\r\n      type: 'error',\r\n      message: err.response?.data?.message || 'Failed to cancel booking'\r\n    });\r\n  } finally {\r\n    isCancelling.value = null;\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  try {\r\n    console.log('Fetching bookings...');\r\n    const data = await userAPI.getBookings();\r\n    console.log('Bookings data:', data);\r\n    bookings.value = Array.isArray(data) ? data : [];\r\n    console.log('Processed bookings:', bookings.value);\r\n  } catch (err) {\r\n    console.error('Failed to load bookings:', err);\r\n    error.value = err.response?.data?.message || 'Failed to load bookings';\r\n    bookings.value = [];\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.bookings-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 2rem 1rem;\r\n}\r\n\r\nh2 {\r\n  font-size: 2rem;\r\n  color: #2c3e50;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.bookings-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1.5rem;\r\n}\r\n\r\n.booking-card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n}\r\n\r\n.booking-header {\r\n  background: #f8fafc;\r\n  padding: 1rem 1.5rem;\r\n  border-bottom: 1px solid #e2e8f0;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.booking-header h3 {\r\n  margin: 0;\r\n  font-size: 1.25rem;\r\n  color: #2c3e50;\r\n}\r\n\r\n.status {\r\n  padding: 0.25rem 0.75rem;\r\n  border-radius: 9999px;\r\n  font-size: 0.875rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.status.confirmed {\r\n  background: #e3fcef;\r\n  color: #42b983;\r\n}\r\n\r\n.status.pending {\r\n  background: #fef3c7;\r\n  color: #d97706;\r\n}\r\n\r\n.status.cancelled {\r\n  background: #fee2e2;\r\n  color: #ef4444;\r\n}\r\n\r\n.booking-info {\r\n  padding: 1.5rem;\r\n}\r\n\r\n.info-row {\r\n  display: flex;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.info-row:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.label {\r\n  flex: 0 0 120px;\r\n  color: #64748b;\r\n  font-weight: 500;\r\n}\r\n\r\n.value {\r\n  flex: 1;\r\n  color: #1e293b;\r\n}\r\n\r\n.loading {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: #64748b;\r\n}\r\n\r\n.error {\r\n  text-align: center;\r\n  padding: 1rem;\r\n  background: #fee2e2;\r\n  color: #ef4444;\r\n  border-radius: 8px;\r\n  margin: 1rem 0;\r\n}\r\n\r\n.no-bookings {\r\n  text-align: center;\r\n  padding: 3rem 1rem;\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.no-bookings p {\r\n  color: #64748b;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.browse-link {\r\n  display: inline-block;\r\n  padding: 0.75rem 1.5rem;\r\n  background: #3b82f6;\r\n  color: white;\r\n  text-decoration: none;\r\n  border-radius: 6px;\r\n  font-weight: 500;\r\n  transition: background-color 0.2s;\r\n}\r\n\r\n.browse-link:hover {\r\n  background: #2563eb;\r\n}\r\n\r\n@media (max-width: 640px) {\r\n  .info-row {\r\n    flex-direction: column;\r\n    gap: 0.25rem;\r\n  }\r\n  \r\n  .label {\r\n    flex: none;\r\n  }\r\n}\r\n\r\n.booking-actions {\r\n  margin-top: 1rem;\r\n  padding-top: 1rem;\r\n  border-top: 1px solid #e2e8f0;\r\n}\r\n\r\n.btn-cancel {\r\n  background: white;\r\n  color: #ef4444;\r\n  border: 1px solid #ef4444;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 6px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.btn-cancel:hover:not(:disabled) {\r\n  background: #fee2e2;\r\n}\r\n\r\n.btn-cancel:disabled {\r\n  opacity: 0.7;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.status.cancelled {\r\n  background: #fee2e2;\r\n  color: #ef4444;\r\n}\r\n</style>\r\n  "],"mappings":"AAiEA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,OAAO,EAAEC,UAAU,QAAQ,gBAAgB;AACpD,SAASC,QAAQ,QAAQ,MAAM;;;;IAE/B,MAAMC,KAAK,GAAGD,QAAQ,CAAC,CAAC;IACxB,MAAME,QAAQ,GAAGN,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMO,OAAO,GAAGP,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMQ,KAAK,GAAGR,GAAG,CAAC,IAAI,CAAC;IACvB,MAAMS,YAAY,GAAGT,GAAG,CAAC,IAAI,CAAC;IAE9B,SAASU,UAAUA,CAACC,UAAU,EAAE;MAC9B,IAAI,CAACA,UAAU,EAAE,OAAO,eAAe;MACvC,IAAI;QACF,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAACF,UAAU,CAAC;QACjC,OAAOC,IAAI,CAACE,kBAAkB,CAAC,OAAO,EAAE;UACtCC,OAAO,EAAE,MAAM;UACfC,IAAI,EAAE,SAAS;UACfC,KAAK,EAAE,MAAM;UACbC,GAAG,EAAE;QACP,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVC,OAAO,CAACZ,KAAK,CAAC,wBAAwB,EAAEW,CAAC,CAAC;QAC1C,OAAOR,UAAU;MACnB;IACF;IAEA,eAAeU,aAAaA,CAACC,SAAS,EAAE;MACtC,IAAI,CAACC,OAAO,CAAC,+CAA+C,CAAC,EAAE;QAC7D;MACF;MAEA,IAAI;QACFd,YAAY,CAACe,KAAK,GAAGF,SAAS;QAC9B,MAAMnB,UAAU,CAACsB,MAAM,CAACH,SAAS,CAAC;;QAElC;QACA,MAAMI,OAAO,GAAGpB,QAAQ,CAACkB,KAAK,CAACG,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKP,SAAS,CAAC;QAC5D,IAAII,OAAO,EAAE;UACXA,OAAO,CAACI,MAAM,GAAG,WAAW;QAC9B;QAEAzB,KAAK,CAAC0B,MAAM,CAAC,iBAAiB,EAAE;UAC9BC,IAAI,EAAE,SAAS;UACfC,OAAO,EAAE;QACX,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZd,OAAO,CAACZ,KAAK,CAAC,2BAA2B,EAAE0B,GAAG,CAAC;QAC/C7B,KAAK,CAAC0B,MAAM,CAAC,iBAAiB,EAAE;UAC9BC,IAAI,EAAE,OAAO;UACbC,OAAO,EAAEC,GAAG,CAACC,QAAQ,EAAEC,IAAI,EAAEH,OAAO,IAAI;QAC1C,CAAC,CAAC;MACJ,CAAC,SAAS;QACRxB,YAAY,CAACe,KAAK,GAAG,IAAI;MAC3B;IACF;IAEAvB,SAAS,CAAC,YAAY;MACpB,IAAI;QACFmB,OAAO,CAACiB,GAAG,CAAC,sBAAsB,CAAC;QACnC,MAAMD,IAAI,GAAG,MAAMlC,OAAO,CAACoC,WAAW,CAAC,CAAC;QACxClB,OAAO,CAACiB,GAAG,CAAC,gBAAgB,EAAED,IAAI,CAAC;QACnC9B,QAAQ,CAACkB,KAAK,GAAGe,KAAK,CAACC,OAAO,CAACJ,IAAI,CAAC,GAAGA,IAAI,GAAG,EAAE;QAChDhB,OAAO,CAACiB,GAAG,CAAC,qBAAqB,EAAE/B,QAAQ,CAACkB,KAAK,CAAC;MACpD,CAAC,CAAC,OAAOU,GAAG,EAAE;QACZd,OAAO,CAACZ,KAAK,CAAC,0BAA0B,EAAE0B,GAAG,CAAC;QAC9C1B,KAAK,CAACgB,KAAK,GAAGU,GAAG,CAACC,QAAQ,EAAEC,IAAI,EAAEH,OAAO,IAAI,yBAAyB;QACtE3B,QAAQ,CAACkB,KAAK,GAAG,EAAE;MACrB,CAAC,SAAS;QACRjB,OAAO,CAACiB,KAAK,GAAG,KAAK;MACvB;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}