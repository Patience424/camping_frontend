{"ast":null,"code":"import Vue from 'vue';\nimport Vuex from 'vuex';\nimport { api } from '@/plugins/axios';\nimport jwtDecode from 'jwt-decode';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    token: localStorage.getItem('token') || null,\n    user: JSON.parse(localStorage.getItem('user')) || null,\n    notification: null,\n    isLoading: false,\n    error: null\n  },\n  getters: {\n    isAuthenticated: state => !!state.token,\n    isUser: state => state.user && state.user.role === 'USER',\n    isOwner: state => state.user && state.user.role === 'OWNER',\n    isAdmin: state => state.user && state.user.role === 'ADMIN',\n    userRole: state => state.user ? state.user.role : null,\n    userId: state => state.user ? state.user.id : null\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n      localStorage.setItem('token', token);\n    },\n    setUser(state, user) {\n      state.user = user;\n      localStorage.setItem('user', JSON.stringify(user));\n    },\n    clearAuth(state) {\n      state.token = null;\n      state.user = null;\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n    },\n    setNotification(state, notification) {\n      state.notification = notification;\n\n      // Auto-clear notification after 5 seconds\n      setTimeout(() => {\n        if (state.notification === notification) {\n          state.notification = null;\n        }\n      }, 5000);\n    },\n    clearNotification(state) {\n      state.notification = null;\n    },\n    setLoading(state, isLoading) {\n      state.isLoading = isLoading;\n    },\n    setError(state, error) {\n      state.error = error;\n    },\n    clearError(state) {\n      state.error = null;\n    }\n  },\n  actions: {\n    async login({\n      commit\n    }, credentials) {\n      try {\n        commit('setLoading', true);\n        console.log('Store: Sending login request with credentials:', credentials);\n        const response = await api.post('/auth/login', credentials);\n        console.log('Store: Login response:', response);\n        if (!response) {\n          console.error('Store: No response received');\n          throw new Error('No response received from server');\n        }\n\n        // Check if response has the expected structure\n        if (!response.token || !response.user) {\n          console.error('Store: Invalid response format:', response);\n          throw new Error('Invalid response format from server');\n        }\n\n        // Store the token and user data\n        commit('setToken', response.token);\n        commit('setUser', response.user);\n        commit('setNotification', {\n          type: 'success',\n          message: response.message || 'Successfully logged in!'\n        });\n        return response.user;\n      } catch (error) {\n        console.error('Store: Login error:', error);\n        if (error.response) {\n          console.error('Store: Error response:', error.response);\n        }\n        throw error;\n      } finally {\n        commit('setLoading', false);\n      }\n    },\n    async register({\n      commit\n    }, userData) {\n      try {\n        commit('setLoading', true);\n        const response = await api.post('/auth/register', userData);\n        const {\n          token,\n          user\n        } = response.data;\n        commit('setToken', token);\n        commit('setUser', user);\n        commit('setNotification', {\n          type: 'success',\n          message: 'Successfully registered!'\n        });\n        return user;\n      } catch (error) {\n        console.error('Registration error:', error.response || error);\n        throw error;\n      } finally {\n        commit('setLoading', false);\n      }\n    },\n    logout({\n      commit\n    }) {\n      commit('clearAuth');\n      commit('setNotification', {\n        type: 'info',\n        message: 'You have been logged out.'\n      });\n    },\n    async checkAuth({\n      state,\n      commit\n    }) {\n      if (!state.token) return false;\n      try {\n        // Check if token is expired\n        const decoded = jwtDecode(state.token);\n        const currentTime = Date.now() / 1000;\n        if (decoded.exp < currentTime) {\n          // Token expired\n          commit('clearAuth');\n          return false;\n        }\n\n        // Token still valid, get current user profile\n        const response = await api.get('/auth/profile');\n        commit('setUser', response.data.user);\n        return true;\n      } catch (error) {\n        console.error('Auth check error:', error);\n        commit('clearAuth');\n        return false;\n      }\n    },\n    async updateProfile({\n      commit,\n      state\n    }, profileData) {\n      try {\n        commit('setLoading', true);\n        const response = await api.put('/users/profile', profileData);\n\n        // Update user data in store\n        const updatedUser = {\n          ...state.user,\n          ...response.data.user\n        };\n        commit('setUser', updatedUser);\n        commit('setNotification', {\n          type: 'success',\n          message: 'Profile updated successfully!'\n        });\n        return updatedUser;\n      } catch (error) {\n        console.error('Update profile error:', error.response || error);\n        throw error;\n      } finally {\n        commit('setLoading', false);\n      }\n    },\n    async changePassword({\n      commit\n    }, passwordData) {\n      try {\n        commit('setLoading', true);\n        await api.put('/users/change-password', passwordData);\n        commit('setNotification', {\n          type: 'success',\n          message: 'Password changed successfully!'\n        });\n      } catch (error) {\n        console.error('Change password error:', error.response || error);\n        throw error;\n      } finally {\n        commit('setLoading', false);\n      }\n    }\n  }\n});","map":{"version":3,"names":["Vue","Vuex","api","jwtDecode","use","Store","state","token","localStorage","getItem","user","JSON","parse","notification","isLoading","error","getters","isAuthenticated","isUser","role","isOwner","isAdmin","userRole","userId","id","mutations","setToken","setItem","setUser","stringify","clearAuth","removeItem","setNotification","setTimeout","clearNotification","setLoading","setError","clearError","actions","login","commit","credentials","console","log","response","post","Error","type","message","register","userData","data","logout","checkAuth","decoded","currentTime","Date","now","exp","get","updateProfile","profileData","put","updatedUser","changePassword","passwordData"],"sources":["C:/Users/pmake/OneDrive - Thomas More/Desktop/Web Programming/Final/project/frontend/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport { api } from '@/plugins/axios'\nimport jwtDecode from 'jwt-decode'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    token: localStorage.getItem('token') || null,\n    user: JSON.parse(localStorage.getItem('user')) || null,\n    notification: null,\n    isLoading: false,\n    error: null\n  },\n  getters: {\n    isAuthenticated: state => !!state.token,\n    isUser: state => state.user && state.user.role === 'USER',\n    isOwner: state => state.user && state.user.role === 'OWNER',\n    isAdmin: state => state.user && state.user.role === 'ADMIN',\n    userRole: state => state.user ? state.user.role : null,\n    userId: state => state.user ? state.user.id : null\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token\n      localStorage.setItem('token', token)\n    },\n    setUser(state, user) {\n      state.user = user\n      localStorage.setItem('user', JSON.stringify(user))\n    },\n    clearAuth(state) {\n      state.token = null\n      state.user = null\n      localStorage.removeItem('token')\n      localStorage.removeItem('user')\n    },\n    setNotification(state, notification) {\n      state.notification = notification\n      \n      // Auto-clear notification after 5 seconds\n      setTimeout(() => {\n        if (state.notification === notification) {\n          state.notification = null\n        }\n      }, 5000)\n    },\n    clearNotification(state) {\n      state.notification = null\n    },\n    setLoading(state, isLoading) {\n      state.isLoading = isLoading\n    },\n    setError(state, error) {\n      state.error = error\n    },\n    clearError(state) {\n      state.error = null\n    }\n  },\n  actions: {\n    async login({ commit }, credentials) {\n      try {\n        commit('setLoading', true)\n        console.log('Store: Sending login request with credentials:', credentials)\n        const response = await api.post('/auth/login', credentials)\n        console.log('Store: Login response:', response)\n        \n        if (!response) {\n          console.error('Store: No response received')\n          throw new Error('No response received from server')\n        }\n        \n        // Check if response has the expected structure\n        if (!response.token || !response.user) {\n          console.error('Store: Invalid response format:', response)\n          throw new Error('Invalid response format from server')\n        }\n        \n        // Store the token and user data\n        commit('setToken', response.token)\n        commit('setUser', response.user)\n        \n        commit('setNotification', {\n          type: 'success',\n          message: response.message || 'Successfully logged in!'\n        })\n        \n        return response.user\n      } catch (error) {\n        console.error('Store: Login error:', error)\n        if (error.response) {\n          console.error('Store: Error response:', error.response)\n        }\n        throw error\n      } finally {\n        commit('setLoading', false)\n      }\n    },\n    \n    async register({ commit }, userData) {\n      try {\n        commit('setLoading', true)\n        const response = await api.post('/auth/register', userData)\n        \n        const { token, user } = response.data\n        \n        commit('setToken', token)\n        commit('setUser', user)\n        \n        commit('setNotification', {\n          type: 'success',\n          message: 'Successfully registered!'\n        })\n        \n        return user\n      } catch (error) {\n        console.error('Registration error:', error.response || error)\n        throw error\n      } finally {\n        commit('setLoading', false)\n      }\n    },\n    \n    logout({ commit }) {\n      commit('clearAuth')\n      commit('setNotification', {\n        type: 'info',\n        message: 'You have been logged out.'\n      })\n    },\n    \n    async checkAuth({ state, commit }) {\n      if (!state.token) return false\n      \n      try {\n        // Check if token is expired\n        const decoded = jwtDecode(state.token)\n        const currentTime = Date.now() / 1000\n        \n        if (decoded.exp < currentTime) {\n          // Token expired\n          commit('clearAuth')\n          return false\n        }\n        \n        // Token still valid, get current user profile\n        const response = await api.get('/auth/profile')\n        commit('setUser', response.data.user)\n        return true\n      } catch (error) {\n        console.error('Auth check error:', error)\n        commit('clearAuth')\n        return false\n      }\n    },\n    \n    async updateProfile({ commit, state }, profileData) {\n      try {\n        commit('setLoading', true)\n        const response = await api.put('/users/profile', profileData)\n        \n        // Update user data in store\n        const updatedUser = { ...state.user, ...response.data.user }\n        commit('setUser', updatedUser)\n        \n        commit('setNotification', {\n          type: 'success',\n          message: 'Profile updated successfully!'\n        })\n        \n        return updatedUser\n      } catch (error) {\n        console.error('Update profile error:', error.response || error)\n        throw error\n      } finally {\n        commit('setLoading', false)\n      }\n    },\n    \n    async changePassword({ commit }, passwordData) {\n      try {\n        commit('setLoading', true)\n        await api.put('/users/change-password', passwordData)\n        \n        commit('setNotification', {\n          type: 'success',\n          message: 'Password changed successfully!'\n        })\n      } catch (error) {\n        console.error('Change password error:', error.response || error)\n        throw error\n      } finally {\n        commit('setLoading', false)\n      }\n    }\n  }\n})"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}