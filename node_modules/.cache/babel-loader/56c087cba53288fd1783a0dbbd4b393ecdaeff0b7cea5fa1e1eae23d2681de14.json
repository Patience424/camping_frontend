{"ast":null,"code":"import { campingSpotAPI } from '@/services/api';\n\n// Add debounce utility\nfunction debounce(fn, delay) {\n  let timeoutId;\n  return function (...args) {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => fn.apply(this, args), delay);\n  };\n}\nexport default {\n  name: 'CampingSpots',\n  data() {\n    return {\n      campingSpots: [],\n      pagination: {\n        page: 1,\n        limit: 9,\n        total: 0,\n        pages: 0\n      },\n      filters: {\n        location: '',\n        priceRange: '',\n        capacity: '',\n        selectedAmenities: [],\n        sort: 'price_asc',\n        appliedAmenities: []\n      },\n      isLoading: false,\n      showAmenitiesDropdown: false,\n      showMapView: false,\n      amenitiesList: [{\n        id: 'WiFi',\n        name: 'WiFi'\n      }, {\n        id: 'Parking',\n        name: 'Parking'\n      }, {\n        id: 'Shower',\n        name: 'Shower'\n      }, {\n        id: 'Toilet',\n        name: 'Toilet'\n      }, {\n        id: 'Fire Pit',\n        name: 'Fire Pit'\n      }, {\n        id: 'Picnic Table',\n        name: 'Picnic Table'\n      }, {\n        id: 'Pets Allowed',\n        name: 'Pets Allowed'\n      }, {\n        id: 'Electricity',\n        name: 'Electricity'\n      }, {\n        id: 'Water',\n        name: 'Water'\n      }, {\n        id: 'Hiking Trails',\n        name: 'Hiking Trails'\n      }],\n      isMobile: false,\n      debouncedFetchCampingSpots: null\n    };\n  },\n  computed: {\n    pageTitle() {\n      if (this.filters.location) {\n        return `Camping Spots in ${this.filters.location}`;\n      }\n      return 'Explore Camping Spots';\n    },\n    hasActiveFilters() {\n      return this.filters.location || this.filters.priceRange || this.filters.capacity || this.filters.selectedAmenities.length > 0;\n    },\n    displayedPages() {\n      const {\n        page,\n        pages\n      } = this.pagination;\n      const maxPagesToShow = 5;\n      if (pages <= maxPagesToShow) {\n        // If total pages is less than the max to show, display all pages\n        return Array.from({\n          length: pages\n        }, (_, i) => i + 1);\n      }\n\n      // Calculate start and end page numbers\n      let startPage = Math.max(1, page - Math.floor(maxPagesToShow / 2));\n      let endPage = startPage + maxPagesToShow - 1;\n\n      // Adjust if end page exceeds total pages\n      if (endPage > pages) {\n        endPage = pages;\n        startPage = Math.max(1, endPage - maxPagesToShow + 1);\n      }\n      return Array.from({\n        length: endPage - startPage + 1\n      }, (_, i) => startPage + i);\n    }\n  },\n  created() {\n    // Create debounced version of fetchCampingSpots\n    this.debouncedFetchCampingSpots = debounce(this.fetchCampingSpots, 300);\n  },\n  methods: {\n    async fetchCampingSpots() {\n      try {\n        this.isLoading = true;\n\n        // Build query parameters\n        const params = {\n          page: this.pagination.page,\n          limit: this.pagination.limit\n        };\n        if (this.filters.location) {\n          params.location = this.filters.location;\n        }\n        if (this.filters.capacity) {\n          params.capacity = this.filters.capacity;\n        }\n\n        // Parse price range\n        if (this.filters.priceRange) {\n          const [min, max] = this.filters.priceRange.split('-');\n          if (min) params.minPrice = min;\n          if (max) params.maxPrice = max;\n        }\n\n        // Add amenities filter if any are selected\n        if (this.filters.appliedAmenities.length > 0) {\n          params.amenities = this.filters.appliedAmenities.join(',');\n        }\n\n        // Apply sorting\n        if (this.filters.sort) {\n          const [field, direction] = this.filters.sort.split('_');\n          params.sortBy = field;\n          params.sortDir = direction;\n        }\n        const response = await campingSpotAPI.getCampingSpots(params);\n        console.log('Camping spots response:', response);\n        this.campingSpots = response.data || [];\n        this.pagination = response.pagination || {\n          page: 1,\n          limit: 9,\n          total: 0,\n          pages: 0\n        };\n      } catch (error) {\n        console.error('Error fetching camping spots:', error);\n        this.$store.commit('setNotification', {\n          type: 'error',\n          message: 'Failed to load camping spots'\n        });\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    toggleAmenitiesDropdown() {\n      this.showAmenitiesDropdown = !this.showAmenitiesDropdown;\n    },\n    applyAmenities() {\n      this.filters.appliedAmenities = [...this.filters.selectedAmenities];\n      this.showAmenitiesDropdown = false;\n      this.pagination.page = 1; // Reset to first page\n      this.fetchCampingSpots();\n    },\n    clearAmenities() {\n      this.filters.selectedAmenities = [];\n      this.filters.appliedAmenities = [];\n      this.showAmenitiesDropdown = false;\n      this.fetchCampingSpots();\n    },\n    clearFilter(filterName) {\n      if (filterName === 'selectedAmenities') {\n        this.filters.selectedAmenities = [];\n        this.filters.appliedAmenities = [];\n      } else {\n        this.filters[filterName] = '';\n      }\n      this.pagination.page = 1; // Reset to first page\n      this.fetchCampingSpots();\n    },\n    clearAllFilters() {\n      this.filters = {\n        location: '',\n        priceRange: '',\n        capacity: '',\n        selectedAmenities: [],\n        appliedAmenities: [],\n        sort: 'price_asc'\n      };\n      this.pagination.page = 1; // Reset to first page\n      this.fetchCampingSpots();\n    },\n    goToPage(page) {\n      if (page < 1 || page > this.pagination.pages) return;\n      this.pagination.page = page;\n      this.fetchCampingSpots();\n      // Scroll to top\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    },\n    toggleView() {\n      this.showMapView = !this.showMapView;\n    },\n    viewSpotDetails(id) {\n      this.$router.push(`/camping-spots/${id}`);\n    },\n    getFirstImage(images) {\n      const defaultImage = 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600';\n      try {\n        if (!images) return defaultImage;\n\n        // If images is a JSON string, parse it\n        if (typeof images === 'string') {\n          try {\n            const parsedImages = JSON.parse(images);\n            if (Array.isArray(parsedImages) && parsedImages.length > 0) {\n              // Try to find the first valid image URL\n              const validImage = parsedImages.find(img => this.isValidImageUrl(img));\n              if (validImage) return validImage;\n            }\n          } catch (e) {\n            // If parsing fails, try using the string directly if it's valid\n            if (this.isValidImageUrl(images)) {\n              return images;\n            }\n          }\n        }\n\n        // If images is already an array, find the first valid image\n        if (Array.isArray(images) && images.length > 0) {\n          const validImage = images.find(img => this.isValidImageUrl(img));\n          if (validImage) return validImage;\n        }\n        return defaultImage;\n      } catch (e) {\n        console.error('Error parsing images:', e);\n        return defaultImage;\n      }\n    },\n    isValidImageUrl(url) {\n      if (!url) return false;\n      if (typeof url !== 'string') return false;\n\n      // Reject blob URLs and invalid protocols\n      if (url.startsWith('blob:') || url.startsWith('data:')) return false;\n\n      // Check if the URL is a valid image URL\n      try {\n        const urlObj = new URL(url);\n        // Only allow http/https protocols and common image domains\n        const validDomains = ['images.pexels.com', 'source.unsplash.com', 'images.unsplash.com'];\n        return (urlObj.protocol === 'http:' || urlObj.protocol === 'https:') && (validDomains.some(domain => urlObj.hostname.includes(domain)) || urlObj.pathname.match(/\\.(jpg|jpeg|png|gif|webp)$/i));\n      } catch (e) {\n        return false;\n      }\n    },\n    handleImageError(event) {\n      const failedUrl = event.target.src;\n      console.warn('Image failed to load:', failedUrl);\n\n      // Prevent infinite loop by checking if we're already using the fallback\n      if (failedUrl === 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600') {\n        event.target.style.display = 'none';\n        return;\n      }\n\n      // Set fallback image\n      event.target.src = 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600';\n\n      // Add error class for styling\n      event.target.classList.add('image-load-error');\n    },\n    truncateDescription(description, length) {\n      if (!description) return '';\n      if (description.length <= length) return description;\n      return description.slice(0, length) + '...';\n    },\n    formatPrice(price) {\n      return new Intl.NumberFormat('de-DE', {\n        style: 'currency',\n        currency: 'EUR'\n      }).format(price);\n    },\n    formatPriceRange(range) {\n      if (!range) return '';\n      const [min, max] = range.split('-');\n      if (min && max) {\n        return `€${min} - €${max}`;\n      } else if (min) {\n        return `Over €${min}`;\n      } else if (max) {\n        return `Under €${max}`;\n      }\n      return range;\n    },\n    checkIfMobile() {\n      this.isMobile = window.innerWidth < 768;\n    },\n    // Apply URL query parameters\n    applyQueryParams() {\n      const query = this.$route.query;\n      if (query.location) {\n        this.filters.location = query.location;\n      }\n      if (query.capacity) {\n        this.filters.capacity = query.capacity;\n      }\n      if (query.minPrice && query.maxPrice) {\n        this.filters.priceRange = `${query.minPrice}-${query.maxPrice}`;\n      } else if (query.minPrice) {\n        this.filters.priceRange = `${query.minPrice}+`;\n      } else if (query.maxPrice) {\n        this.filters.priceRange = `0-${query.maxPrice}`;\n      }\n      if (query.amenities) {\n        const amenitiesList = query.amenities.split(',');\n        this.filters.selectedAmenities = amenitiesList;\n        this.filters.appliedAmenities = amenitiesList;\n      }\n      if (query.page) {\n        this.pagination.page = parseInt(query.page);\n      }\n      if (query.sort) {\n        this.filters.sort = query.sort;\n      }\n    },\n    // Update the filter watchers to use debounced fetch\n    handleFilterChange() {\n      this.pagination.page = 1;\n      this.debouncedFetchCampingSpots();\n    }\n  },\n  mounted() {\n    this.applyQueryParams();\n    this.fetchCampingSpots();\n    this.checkIfMobile();\n    window.addEventListener('resize', this.checkIfMobile);\n\n    // Close amenities dropdown when clicking outside\n    document.addEventListener('click', e => {\n      if (this.showAmenitiesDropdown && !e.target.closest('.amenities-dropdown') && !e.target.closest('button')) {\n        this.showAmenitiesDropdown = false;\n      }\n    });\n  },\n  beforeDestroy() {\n    window.removeEventListener('resize', this.checkIfMobile);\n  },\n  watch: {\n    // Update watchers to use the new handler\n    'filters.location'() {\n      this.handleFilterChange();\n    },\n    'filters.priceRange'() {\n      this.handleFilterChange();\n    },\n    'filters.capacity'() {\n      this.handleFilterChange();\n    },\n    'filters.sort'() {\n      this.debouncedFetchCampingSpots();\n    },\n    // Keep immediate fetch for route changes\n    '$route.query'() {\n      this.applyQueryParams();\n      this.fetchCampingSpots();\n    }\n  }\n};","map":{"version":3,"names":["campingSpotAPI","debounce","fn","delay","timeoutId","args","clearTimeout","setTimeout","apply","name","data","campingSpots","pagination","page","limit","total","pages","filters","location","priceRange","capacity","selectedAmenities","sort","appliedAmenities","isLoading","showAmenitiesDropdown","showMapView","amenitiesList","id","isMobile","debouncedFetchCampingSpots","computed","pageTitle","hasActiveFilters","length","displayedPages","maxPagesToShow","Array","from","_","i","startPage","Math","max","floor","endPage","created","fetchCampingSpots","methods","params","min","split","minPrice","maxPrice","amenities","join","field","direction","sortBy","sortDir","response","getCampingSpots","console","log","error","$store","commit","type","message","toggleAmenitiesDropdown","applyAmenities","clearAmenities","clearFilter","filterName","clearAllFilters","goToPage","window","scrollTo","top","behavior","toggleView","viewSpotDetails","$router","push","getFirstImage","images","defaultImage","parsedImages","JSON","parse","isArray","validImage","find","img","isValidImageUrl","e","url","startsWith","urlObj","URL","validDomains","protocol","some","domain","hostname","includes","pathname","match","handleImageError","event","failedUrl","target","src","warn","style","display","classList","add","truncateDescription","description","slice","formatPrice","price","Intl","NumberFormat","currency","format","formatPriceRange","range","checkIfMobile","innerWidth","applyQueryParams","query","$route","parseInt","handleFilterChange","mounted","addEventListener","document","closest","beforeDestroy","removeEventListener","watch","filters.location","filters.priceRange","filters.capacity","filters.sort","$route.query"],"sources":["src/views/camping/CampingSpots.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-neutral-50\">\r\n    <!-- Filter Header -->\r\n    <div class=\"bg-white shadow-sm py-4 sticky top-16 z-30\">\r\n      <div class=\"container mx-auto px-4\">\r\n        <div class=\"flex flex-col md:flex-row md:items-center justify-between\">\r\n          <h1 class=\"text-2xl font-bold mb-4 md:mb-0\">{{ pageTitle }}</h1>\r\n          \r\n          <div class=\"flex flex-wrap gap-2\">\r\n            <!-- Location filter -->\r\n            <div class=\"relative\">\r\n              <input\r\n                type=\"text\"\r\n                v-model=\"filters.location\"\r\n                placeholder=\"Location\"\r\n                class=\"form-input py-2 pl-8 pr-4 rounded-full text-sm\"\r\n              >\r\n              <svg class=\"h-4 w-4 text-neutral-500 absolute left-3 top-1/2 transform -translate-y-1/2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </div>\r\n            \r\n            <!-- Price range filter -->\r\n            <div class=\"relative\">\r\n              <select v-model=\"filters.priceRange\" class=\"form-input py-2 pl-8 pr-4 rounded-full text-sm\">\r\n                <option value=\"\">Any price</option>\r\n                <option value=\"0-50\">Under $50</option>\r\n                <option value=\"50-100\">$50 - $100</option>\r\n                <option value=\"100-200\">$100 - $200</option>\r\n                <option value=\"200+\">$200+</option>\r\n              </select>\r\n              <svg class=\"h-4 w-4 text-neutral-500 absolute left-3 top-1/2 transform -translate-y-1/2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path d=\"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z\" />\r\n                <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </div>\r\n            \r\n            <!-- Capacity filter -->\r\n            <div class=\"relative\">\r\n              <select v-model=\"filters.capacity\" class=\"form-input py-2 pl-8 pr-4 rounded-full text-sm\">\r\n                <option value=\"\">Any capacity</option>\r\n                <option value=\"1\">1 Person</option>\r\n                <option value=\"2\">2 People</option>\r\n                <option value=\"3\">3 People</option>\r\n                <option value=\"4\">4 People</option>\r\n                <option value=\"5\">5+ People</option>\r\n              </select>\r\n              <svg class=\"h-4 w-4 text-neutral-500 absolute left-3 top-1/2 transform -translate-y-1/2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path d=\"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z\" />\r\n              </svg>\r\n            </div>\r\n            \r\n            <!-- Amenities filter (dropdown) -->\r\n            <div class=\"relative\">\r\n              <button \r\n                @click.stop=\"toggleAmenitiesDropdown\" \r\n                class=\"form-input py-2 pl-8 pr-4 rounded-full text-sm flex items-center\"\r\n              >\r\n                <span>Amenities</span>\r\n                <svg class=\"h-4 w-4 ml-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fill-rule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n              <svg class=\"h-4 w-4 text-neutral-500 absolute left-3 top-1/2 transform -translate-y-1/2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n              \r\n              <!-- Amenities dropdown -->\r\n              <div v-if=\"showAmenitiesDropdown\" class=\"absolute top-full mt-2 left-0 bg-white rounded-lg shadow-lg p-3 z-10 w-56 amenities-dropdown\" @click.stop>\r\n                <div v-for=\"amenity in amenitiesList\" :key=\"amenity.id\" class=\"flex items-center mb-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    :id=\"`amenity-${amenity.id}`\"\r\n                    v-model=\"filters.selectedAmenities\"\r\n                    :value=\"amenity.id\"\r\n                    class=\"mr-2\"\r\n                  >\r\n                  <label :for=\"`amenity-${amenity.id}`\" class=\"text-sm\">{{ amenity.name }}</label>\r\n                </div>\r\n                <div class=\"mt-3 flex justify-end\">\r\n                  <button @click.stop=\"clearAmenities\" class=\"text-xs text-neutral-500 mr-2\">Clear</button>\r\n                  <button @click.stop=\"applyAmenities\" class=\"text-xs text-primary-500 font-medium\">Apply</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <!-- Sort dropdown -->\r\n            <div class=\"relative ml-auto\">\r\n              <select v-model=\"filters.sort\" class=\"form-input py-2 pl-8 pr-4 rounded-full text-sm\">\r\n                <option value=\"price_asc\">Price: Low to High</option>\r\n                <option value=\"price_desc\">Price: High to Low</option>\r\n                <option value=\"rating_desc\">Highest Rated</option>\r\n                <option value=\"newest\">Newest</option>\r\n              </select>\r\n              <svg class=\"h-4 w-4 text-neutral-500 absolute left-3 top-1/2 transform -translate-y-1/2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path d=\"M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Main Content -->\r\n    <div class=\"container mx-auto px-4 py-8\">\r\n      <div class=\"md:flex\">\r\n        <!-- Active Filters -->\r\n        <div v-if=\"hasActiveFilters\" class=\"mb-6 w-full\">\r\n          <div class=\"flex flex-wrap gap-2 items-center\">\r\n            <span class=\"text-sm font-medium text-neutral-600\">Active filters:</span>\r\n            \r\n            <button \r\n              v-if=\"filters.location\" \r\n              @click=\"clearFilter('location')\" \r\n              class=\"inline-flex items-center bg-primary-50 text-primary-700 rounded-full px-3 py-1 text-xs\"\r\n            >\r\n              Location: {{ filters.location }}\r\n              <svg class=\"h-3 w-3 ml-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <button \r\n              v-if=\"filters.capacity\" \r\n              @click=\"clearFilter('capacity')\" \r\n              class=\"inline-flex items-center bg-primary-50 text-primary-700 rounded-full px-3 py-1 text-xs\"\r\n            >\r\n              Capacity: {{ filters.capacity }}+ people\r\n              <svg class=\"h-3 w-3 ml-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <button \r\n              v-if=\"filters.priceRange\" \r\n              @click=\"clearFilter('priceRange')\" \r\n              class=\"inline-flex items-center bg-primary-50 text-primary-700 rounded-full px-3 py-1 text-xs\"\r\n            >\r\n              Price: {{ formatPriceRange(filters.priceRange) }}\r\n              <svg class=\"h-3 w-3 ml-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <button \r\n              v-if=\"filters.appliedAmenities.length > 0\" \r\n              @click=\"clearFilter('selectedAmenities')\" \r\n              class=\"inline-flex items-center bg-primary-50 text-primary-700 rounded-full px-3 py-1 text-xs\"\r\n            >\r\n              {{ filters.appliedAmenities.length }} amenities selected\r\n              <svg class=\"h-3 w-3 ml-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <button \r\n              @click=\"clearAllFilters\" \r\n              class=\"text-neutral-600 text-xs hover:text-neutral-800 underline ml-2\"\r\n            >\r\n              Clear all filters\r\n            </button>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Map View Toggle -->\r\n        <div class=\"mb-6 flex justify-end w-full\">\r\n          <button \r\n            @click=\"toggleView\" \r\n            class=\"inline-flex items-center text-sm font-medium text-primary-600 hover:text-primary-800\"\r\n          >\r\n            <svg v-if=\"showMapView\" class=\"h-5 w-5 mr-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path fill-rule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clip-rule=\"evenodd\" />\r\n            </svg>\r\n            <svg v-else class=\"h-5 w-5 mr-1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path fill-rule=\"evenodd\" d=\"M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z\" clip-rule=\"evenodd\" />\r\n            </svg>\r\n            {{ showMapView ? 'Show List View' : 'Show Map View' }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Map and List Views -->\r\n      <div class=\"md:flex md:space-x-8\">\r\n        <!-- Camping Spots List -->\r\n        <div v-if=\"!showMapView || isMobile\" class=\"md:w-full\">\r\n          <div v-if=\"isLoading\" class=\"flex justify-center py-20\">\r\n            <svg class=\"animate-spin h-10 w-10 text-primary-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n              <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n              <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n            </svg>\r\n          </div>\r\n          \r\n          <div v-else-if=\"campingSpots.length === 0\" class=\"text-center py-20\">\r\n            <svg class=\"w-16 h-16 text-neutral-300 mx-auto mb-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n            </svg>\r\n            <h3 class=\"text-xl font-semibold mb-2\">No camping spots found</h3>\r\n            <p class=\"text-neutral-600 mb-6\">Try adjusting your filters to find more options</p>\r\n            <button @click=\"clearAllFilters\" class=\"btn-primary\">Clear all filters</button>\r\n          </div>\r\n          \r\n          <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            <div \r\n              v-for=\"spot in campingSpots\" \r\n              :key=\"spot.id\" \r\n              class=\"card group cursor-pointer hover:transform hover:scale-[1.02] transition-all duration-300\"\r\n              @click=\"viewSpotDetails(spot.id)\"\r\n            >\r\n              <div class=\"relative h-48 md:h-56 rounded-lg overflow-hidden mb-4\">\r\n                <img \r\n                  :src=\"getFirstImage(spot.images)\" \r\n                  :alt=\"spot.name\" \r\n                  class=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\"\r\n                  @error=\"handleImageError\"\r\n                  loading=\"lazy\"\r\n                >\r\n                <div class=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent text-white p-4\">\r\n                  <div v-if=\"spot.averageRating\" class=\"flex items-center bg-black/50 rounded-full px-2 py-1 w-fit\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 text-yellow-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                      <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\" />\r\n                    </svg>\r\n                    <span class=\"ml-1 text-xs\">{{ spot.averageRating.toFixed(1) }}</span>\r\n                    <span class=\"ml-1 text-xs\">({{ spot.reviewCount || 0 }})</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"p-2\">\r\n                <h3 class=\"text-xl font-bold mb-2\">{{ spot.name }}</h3>\r\n                <p class=\"text-neutral-600 mb-2 flex items-center\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-1 text-neutral-500\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                    <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\" />\r\n                  </svg>\r\n                  {{ spot.location }}\r\n                </p>\r\n                <p class=\"text-neutral-600 mb-4\">{{ truncateDescription(spot.description, 100) }}</p>\r\n                <div class=\"flex justify-between items-center\">\r\n                  <div>\r\n                    <span class=\"font-bold text-lg\">{{ formatPrice(spot.pricePerNight) }}</span>\r\n                    <span class=\"text-neutral-600\">/night</span>\r\n                  </div>\r\n                  <router-link :to=\"`/camping-spots/${spot.id}`\" class=\"btn-primary\">View Details</router-link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- Pagination -->\r\n          <div v-if=\"pagination.pages > 1\" class=\"mt-10 flex justify-center\">\r\n            <div class=\"flex space-x-1\">\r\n              <button \r\n                @click=\"goToPage(pagination.page - 1)\" \r\n                :disabled=\"pagination.page === 1\"\r\n                :class=\"[\r\n                  'px-3 py-1 rounded-md',\r\n                  pagination.page === 1 \r\n                    ? 'bg-neutral-100 text-neutral-400 cursor-not-allowed' \r\n                    : 'bg-white text-neutral-700 hover:bg-neutral-100'\r\n                ]\"\r\n              >\r\n                <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fill-rule=\"evenodd\" d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n              \r\n              <button \r\n                v-for=\"page in displayedPages\" \r\n                :key=\"page\" \r\n                @click=\"goToPage(page)\"\r\n                :class=\"[\r\n                  'px-3 py-1 rounded-md',\r\n                  page === pagination.page \r\n                    ? 'bg-primary-500 text-white' \r\n                    : 'bg-white text-neutral-700 hover:bg-neutral-100'\r\n                ]\"\r\n              >\r\n                {{ page }}\r\n              </button>\r\n              \r\n              <button \r\n                @click=\"goToPage(pagination.page + 1)\" \r\n                :disabled=\"pagination.page === pagination.pages\"\r\n                :class=\"[\r\n                  'px-3 py-1 rounded-md',\r\n                  pagination.page === pagination.pages \r\n                    ? 'bg-neutral-100 text-neutral-400 cursor-not-allowed' \r\n                    : 'bg-white text-neutral-700 hover:bg-neutral-100'\r\n                ]\"\r\n              >\r\n                <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Map View (This would be implemented with a library like leaflet or google maps) -->\r\n        <div v-if=\"showMapView && !isMobile\" class=\"w-full h-[800px] bg-neutral-100 rounded-xl relative overflow-hidden\">\r\n          <div class=\"absolute inset-0 flex items-center justify-center text-neutral-500\">\r\n            <div class=\"text-center\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-16 w-16 mx-auto mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7\" />\r\n              </svg>\r\n              <p class=\"text-xl font-semibold\">Map View</p>\r\n              <p class=\"text-sm\">(Interactive map would be implemented here)</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { campingSpotAPI } from '@/services/api'\r\n\r\n// Add debounce utility\r\nfunction debounce(fn, delay) {\r\n  let timeoutId\r\n  return function (...args) {\r\n    clearTimeout(timeoutId)\r\n    timeoutId = setTimeout(() => fn.apply(this, args), delay)\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: 'CampingSpots',\r\n  data() {\r\n    return {\r\n      campingSpots: [],\r\n      pagination: {\r\n        page: 1,\r\n        limit: 9,\r\n        total: 0,\r\n        pages: 0\r\n      },\r\n      filters: {\r\n        location: '',\r\n        priceRange: '',\r\n        capacity: '',\r\n        selectedAmenities: [],\r\n        sort: 'price_asc',\r\n        appliedAmenities: []\r\n      },\r\n      isLoading: false,\r\n      showAmenitiesDropdown: false,\r\n      showMapView: false,\r\n      amenitiesList: [\r\n        { id: 'WiFi', name: 'WiFi' },\r\n        { id: 'Parking', name: 'Parking' },\r\n        { id: 'Shower', name: 'Shower' },\r\n        { id: 'Toilet', name: 'Toilet' },\r\n        { id: 'Fire Pit', name: 'Fire Pit' },\r\n        { id: 'Picnic Table', name: 'Picnic Table' },\r\n        { id: 'Pets Allowed', name: 'Pets Allowed' },\r\n        { id: 'Electricity', name: 'Electricity' },\r\n        { id: 'Water', name: 'Water' },\r\n        { id: 'Hiking Trails', name: 'Hiking Trails' }\r\n      ],\r\n      isMobile: false,\r\n      debouncedFetchCampingSpots: null\r\n    }\r\n  },\r\n  computed: {\r\n    pageTitle() {\r\n      if (this.filters.location) {\r\n        return `Camping Spots in ${this.filters.location}`\r\n      }\r\n      return 'Explore Camping Spots'\r\n    },\r\n    hasActiveFilters() {\r\n      return (\r\n        this.filters.location ||\r\n        this.filters.priceRange ||\r\n        this.filters.capacity ||\r\n        this.filters.selectedAmenities.length > 0\r\n      )\r\n    },\r\n    displayedPages() {\r\n      const { page, pages } = this.pagination\r\n      const maxPagesToShow = 5\r\n      \r\n      if (pages <= maxPagesToShow) {\r\n        // If total pages is less than the max to show, display all pages\r\n        return Array.from({ length: pages }, (_, i) => i + 1)\r\n      }\r\n      \r\n      // Calculate start and end page numbers\r\n      let startPage = Math.max(1, page - Math.floor(maxPagesToShow / 2))\r\n      let endPage = startPage + maxPagesToShow - 1\r\n      \r\n      // Adjust if end page exceeds total pages\r\n      if (endPage > pages) {\r\n        endPage = pages\r\n        startPage = Math.max(1, endPage - maxPagesToShow + 1)\r\n      }\r\n      \r\n      return Array.from({ length: endPage - startPage + 1 }, (_, i) => startPage + i)\r\n    }\r\n  },\r\n  created() {\r\n    // Create debounced version of fetchCampingSpots\r\n    this.debouncedFetchCampingSpots = debounce(this.fetchCampingSpots, 300)\r\n  },\r\n  methods: {\r\n    async fetchCampingSpots() {\r\n      try {\r\n        this.isLoading = true\r\n        \r\n        // Build query parameters\r\n        const params = {\r\n          page: this.pagination.page,\r\n          limit: this.pagination.limit\r\n        }\r\n        \r\n        if (this.filters.location) {\r\n          params.location = this.filters.location\r\n        }\r\n        \r\n        if (this.filters.capacity) {\r\n          params.capacity = this.filters.capacity\r\n        }\r\n        \r\n        // Parse price range\r\n        if (this.filters.priceRange) {\r\n          const [min, max] = this.filters.priceRange.split('-')\r\n          if (min) params.minPrice = min\r\n          if (max) params.maxPrice = max\r\n        }\r\n        \r\n        // Add amenities filter if any are selected\r\n        if (this.filters.appliedAmenities.length > 0) {\r\n          params.amenities = this.filters.appliedAmenities.join(',')\r\n        }\r\n        \r\n        // Apply sorting\r\n        if (this.filters.sort) {\r\n          const [field, direction] = this.filters.sort.split('_')\r\n          params.sortBy = field\r\n          params.sortDir = direction\r\n        }\r\n        \r\n        const response = await campingSpotAPI.getCampingSpots(params)\r\n        console.log('Camping spots response:', response)\r\n        \r\n        this.campingSpots = response.data || []\r\n        this.pagination = response.pagination || {\r\n          page: 1,\r\n          limit: 9,\r\n          total: 0,\r\n          pages: 0\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching camping spots:', error)\r\n        this.$store.commit('setNotification', {\r\n          type: 'error',\r\n          message: 'Failed to load camping spots'\r\n        })\r\n      } finally {\r\n        this.isLoading = false\r\n      }\r\n    },\r\n    \r\n    toggleAmenitiesDropdown() {\r\n      this.showAmenitiesDropdown = !this.showAmenitiesDropdown\r\n    },\r\n    \r\n    applyAmenities() {\r\n      this.filters.appliedAmenities = [...this.filters.selectedAmenities]\r\n      this.showAmenitiesDropdown = false\r\n      this.pagination.page = 1 // Reset to first page\r\n      this.fetchCampingSpots()\r\n    },\r\n    \r\n    clearAmenities() {\r\n      this.filters.selectedAmenities = []\r\n      this.filters.appliedAmenities = []\r\n      this.showAmenitiesDropdown = false\r\n      this.fetchCampingSpots()\r\n    },\r\n    \r\n    clearFilter(filterName) {\r\n      if (filterName === 'selectedAmenities') {\r\n        this.filters.selectedAmenities = []\r\n        this.filters.appliedAmenities = []\r\n      } else {\r\n        this.filters[filterName] = ''\r\n      }\r\n      this.pagination.page = 1 // Reset to first page\r\n      this.fetchCampingSpots()\r\n    },\r\n    \r\n    clearAllFilters() {\r\n      this.filters = {\r\n        location: '',\r\n        priceRange: '',\r\n        capacity: '',\r\n        selectedAmenities: [],\r\n        appliedAmenities: [],\r\n        sort: 'price_asc'\r\n      }\r\n      this.pagination.page = 1 // Reset to first page\r\n      this.fetchCampingSpots()\r\n    },\r\n    \r\n    goToPage(page) {\r\n      if (page < 1 || page > this.pagination.pages) return\r\n      this.pagination.page = page\r\n      this.fetchCampingSpots()\r\n      // Scroll to top\r\n      window.scrollTo({ top: 0, behavior: 'smooth' })\r\n    },\r\n    \r\n    toggleView() {\r\n      this.showMapView = !this.showMapView\r\n    },\r\n    \r\n    viewSpotDetails(id) {\r\n      this.$router.push(`/camping-spots/${id}`)\r\n    },\r\n    \r\n    getFirstImage(images) {\r\n      const defaultImage = 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600'\r\n      \r\n      try {\r\n        if (!images) return defaultImage\r\n        \r\n        // If images is a JSON string, parse it\r\n        if (typeof images === 'string') {\r\n          try {\r\n            const parsedImages = JSON.parse(images)\r\n            if (Array.isArray(parsedImages) && parsedImages.length > 0) {\r\n              // Try to find the first valid image URL\r\n              const validImage = parsedImages.find(img => this.isValidImageUrl(img))\r\n              if (validImage) return validImage\r\n            }\r\n          } catch (e) {\r\n            // If parsing fails, try using the string directly if it's valid\r\n            if (this.isValidImageUrl(images)) {\r\n              return images\r\n            }\r\n          }\r\n        }\r\n        \r\n        // If images is already an array, find the first valid image\r\n        if (Array.isArray(images) && images.length > 0) {\r\n          const validImage = images.find(img => this.isValidImageUrl(img))\r\n          if (validImage) return validImage\r\n        }\r\n        \r\n        return defaultImage\r\n      } catch (e) {\r\n        console.error('Error parsing images:', e)\r\n        return defaultImage\r\n      }\r\n    },\r\n    \r\n    isValidImageUrl(url) {\r\n      if (!url) return false\r\n      if (typeof url !== 'string') return false\r\n      \r\n      // Reject blob URLs and invalid protocols\r\n      if (url.startsWith('blob:') || url.startsWith('data:')) return false\r\n      \r\n      // Check if the URL is a valid image URL\r\n      try {\r\n        const urlObj = new URL(url)\r\n        // Only allow http/https protocols and common image domains\r\n        const validDomains = ['images.pexels.com', 'source.unsplash.com', 'images.unsplash.com']\r\n        return (urlObj.protocol === 'http:' || urlObj.protocol === 'https:') &&\r\n               (validDomains.some(domain => urlObj.hostname.includes(domain)) || \r\n                urlObj.pathname.match(/\\.(jpg|jpeg|png|gif|webp)$/i))\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    },\r\n    \r\n    handleImageError(event) {\r\n      const failedUrl = event.target.src\r\n      console.warn('Image failed to load:', failedUrl)\r\n      \r\n      // Prevent infinite loop by checking if we're already using the fallback\r\n      if (failedUrl === 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600') {\r\n        event.target.style.display = 'none'\r\n        return\r\n      }\r\n      \r\n      // Set fallback image\r\n      event.target.src = 'https://images.pexels.com/photos/6271625/pexels-photo-6271625.jpeg?auto=compress&cs=tinysrgb&w=1600'\r\n      \r\n      // Add error class for styling\r\n      event.target.classList.add('image-load-error')\r\n    },\r\n    \r\n    truncateDescription(description, length) {\r\n      if (!description) return ''\r\n      if (description.length <= length) return description\r\n      return description.slice(0, length) + '...'\r\n    },\r\n    \r\n    formatPrice(price) {\r\n      return new Intl.NumberFormat('de-DE', {\r\n        style: 'currency',\r\n        currency: 'EUR'\r\n      }).format(price)\r\n    },\r\n    \r\n    formatPriceRange(range) {\r\n      if (!range) return ''\r\n      \r\n      const [min, max] = range.split('-')\r\n      \r\n      if (min && max) {\r\n        return `€${min} - €${max}`\r\n      } else if (min) {\r\n        return `Over €${min}`\r\n      } else if (max) {\r\n        return `Under €${max}`\r\n      }\r\n      \r\n      return range\r\n    },\r\n    \r\n    checkIfMobile() {\r\n      this.isMobile = window.innerWidth < 768\r\n    },\r\n    \r\n    // Apply URL query parameters\r\n    applyQueryParams() {\r\n      const query = this.$route.query\r\n      \r\n      if (query.location) {\r\n        this.filters.location = query.location\r\n      }\r\n      \r\n      if (query.capacity) {\r\n        this.filters.capacity = query.capacity\r\n      }\r\n      \r\n      if (query.minPrice && query.maxPrice) {\r\n        this.filters.priceRange = `${query.minPrice}-${query.maxPrice}`\r\n      } else if (query.minPrice) {\r\n        this.filters.priceRange = `${query.minPrice}+`\r\n      } else if (query.maxPrice) {\r\n        this.filters.priceRange = `0-${query.maxPrice}`\r\n      }\r\n      \r\n      if (query.amenities) {\r\n        const amenitiesList = query.amenities.split(',')\r\n        this.filters.selectedAmenities = amenitiesList\r\n        this.filters.appliedAmenities = amenitiesList\r\n      }\r\n      \r\n      if (query.page) {\r\n        this.pagination.page = parseInt(query.page)\r\n      }\r\n      \r\n      if (query.sort) {\r\n        this.filters.sort = query.sort\r\n      }\r\n    },\r\n    \r\n    // Update the filter watchers to use debounced fetch\r\n    handleFilterChange() {\r\n      this.pagination.page = 1\r\n      this.debouncedFetchCampingSpots()\r\n    }\r\n  },\r\n  mounted() {\r\n    this.applyQueryParams()\r\n    this.fetchCampingSpots()\r\n    this.checkIfMobile()\r\n    window.addEventListener('resize', this.checkIfMobile)\r\n    \r\n    // Close amenities dropdown when clicking outside\r\n    document.addEventListener('click', (e) => {\r\n      if (this.showAmenitiesDropdown && !e.target.closest('.amenities-dropdown') && !e.target.closest('button')) {\r\n        this.showAmenitiesDropdown = false\r\n      }\r\n    })\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('resize', this.checkIfMobile)\r\n  },\r\n  watch: {\r\n    // Update watchers to use the new handler\r\n    'filters.location'() {\r\n      this.handleFilterChange()\r\n    },\r\n    'filters.priceRange'() {\r\n      this.handleFilterChange()\r\n    },\r\n    'filters.capacity'() {\r\n      this.handleFilterChange()\r\n    },\r\n    'filters.sort'() {\r\n      this.debouncedFetchCampingSpots()\r\n    },\r\n    // Keep immediate fetch for route changes\r\n    '$route.query'() {\r\n      this.applyQueryParams()\r\n      this.fetchCampingSpots()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.spot-image {\r\n  width: 100%;\r\n  height: 200px;\r\n  object-fit: cover;\r\n  border-radius: 8px 8px 0 0;\r\n  transition: transform 0.2s ease-in-out;\r\n  background-color: #f3f4f6; /* Light gray background while loading */\r\n}\r\n\r\n.spot-image:hover {\r\n  transform: scale(1.05);\r\n}\r\n\r\n.image-container {\r\n  overflow: hidden;\r\n  border-radius: 8px 8px 0 0;\r\n  position: relative;\r\n  background-color: #f3f4f6;\r\n}\r\n\r\n.image-load-error {\r\n  opacity: 0.5;\r\n  filter: grayscale(100%);\r\n}\r\n\r\n/* Add loading placeholder */\r\n.spot-image:not([src]), \r\n.spot-image[src=\"\"],\r\n.spot-image[src=\"undefined\"] {\r\n  visibility: hidden;\r\n}\r\n\r\n.spot-image:not([src])::after,\r\n.spot-image[src=\"\"]::after,\r\n.spot-image[src=\"undefined\"]::after {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);\r\n  background-size: 200% 100%;\r\n  animation: loading 1.5s infinite;\r\n}\r\n\r\n@keyframes loading {\r\n  0% {\r\n    background-position: 200% 0;\r\n  }\r\n  100% {\r\n    background-position: -200% 0;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}